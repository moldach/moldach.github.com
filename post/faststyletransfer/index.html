<!DOCTYPE html>
<!-- This site was created with Hugo Blox. https://hugoblox.com -->
<!-- Last Published: December 6, 2023 --><html lang="en-us" >


<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Hugo Blox Builder 5.9.6" />
  

  
  












  
  










  







  
  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
  

  
  

  

  <link rel="stylesheet" href="/css/vendor-bundle.min.047268c6dd09ad74ba54a0ba71837064.css" media="print" onload="this.media='all'">

  
  
  
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1.9.4/css/academicons.min.css" integrity="sha512-IW0nhlW5MgNydsXJO40En2EoCkTTjZhI3yuODrZIc8cQ4h1XcF53PsqDHa09NqnkXuIe0Oiyyj171BqZFwISBw==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    
    
    
    
      
      
    
    
    

    
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.min.css" integrity="" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      
        
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.32e2e32cf1a4c1ea152e519f8b1fda79.css" />

  
  
  

  
  
  
  
  
  
  
    
    
    <link rel="stylesheet" href="/css/libs/chroma/github-light.min.css" title="hl-light" media="print" onload="this.media='all'" >
    <link rel="stylesheet" href="/css/libs/chroma/dracula.min.css" title="hl-dark" media="print" onload="this.media='all'" disabled>
  

  
  



























  
  
  






  <meta name="author" content="Matthew J. Oldach, M.Sc." />





  

<meta name="description" content="Volcom was founded in 1991, it was the first company to combine skateboarding, surfing and snowboarding under one brand from it&rsquo;s incepetion. I always loved how their aesthethics captured the energy and artistry of board-riding in its purest form." />



<link rel="alternate" hreflang="en-us" href="https://example.com/post/faststyletransfer/" />
<link rel="canonical" href="https://example.com/post/faststyletransfer/" />



  <link rel="manifest" href="/manifest.webmanifest" />



<link rel="icon" type="image/png" href="/media/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_32x32_fill_lanczos_center_3.png" />
<link rel="apple-touch-icon" type="image/png" href="/media/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_180x180_fill_lanczos_center_3.png" />

<meta name="theme-color" content="#1565c0" />










  






<meta property="twitter:card" content="summary_large_image" />

  <meta property="twitter:site" content="@GetResearchDev" />
  <meta property="twitter:creator" content="@GetResearchDev" />
<meta property="twitter:image" content="https://example.com/post/faststyletransfer/featured.png" />



  

<meta property="og:type" content="article" />
<meta property="og:site_name" content="Academic" />
<meta property="og:url" content="https://example.com/post/faststyletransfer/" />
<meta property="og:title" content="TensorFlow CNN for Fast Style Transfer | Academic" />
<meta property="og:description" content="Volcom was founded in 1991, it was the first company to combine skateboarding, surfing and snowboarding under one brand from it&rsquo;s incepetion. I always loved how their aesthethics captured the energy and artistry of board-riding in its purest form." /><meta property="og:image" content="https://example.com/post/faststyletransfer/featured.png" /><meta property="og:locale" content="en-us" />

  
    <meta
      property="article:published_time"
      content="2019-04-21T00:00:00&#43;00:00"
    />
  
  
    <meta property="article:modified_time" content="2019-04-21T00:00:00&#43;00:00">
  






    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://example.com/post/faststyletransfer/"
  },
  "headline": "TensorFlow CNN for Fast Style Transfer",
  
  "image": [
    "https://example.com/post/faststyletransfer/featured.png"
  ],
  
  "datePublished": "2019-04-21T00:00:00Z",
  "dateModified": "2019-04-21T00:00:00Z",
  
  "author": {
    "@type": "Person",
    "name": "Matthew J. Oldach"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Academic",
    "logo": {
      "@type": "ImageObject",
      "url": "https://example.com/media/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_192x192_fill_lanczos_center_3.png"
    }
  },
  "description": "Volcom was founded in 1991, it was the first company to combine skateboarding, surfing and snowboarding under one brand from it\u0026rsquo;s incepetion. I always loved how their aesthethics captured the energy and artistry of board-riding in its purest form."
}
</script>

  

  




  
  
  

  
  

  


  
  <title>TensorFlow CNN for Fast Style Transfer | Academic</title>

  
  
  
  











</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="4c9587f5d30f42fac519d583f09a80f1" >

  
  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.3a6bdbdff5d8a89d6e651adb3deec035.js"></script>

  


<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Search...">
        
      </div>

      
      

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header header--fixed">
  
  
  
  
  












<header>
  <nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
    <div class="container-xl">

      
      <div class="d-none d-lg-inline-flex">
        <a class="navbar-brand" href="/">Academic</a>
      </div>
      

      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="Toggle navigation">
      <span><i class="fas fa-bars"></i></span>
      </button>
      

      
      <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
        <a class="navbar-brand" href="/">Academic</a>
      </div>
      

      
      
      <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

        
        <ul class="navbar-nav d-md-inline-flex">
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#about"><span>Home</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#posts"><span>Posts</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#projects"><span>Projects</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#talks"><span>Talks</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#contact"><span>Contact</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/uploads/resume.pdf"><span>CV</span></a>
          </li>

          
          

        

          
        </ul>
      </div>

      <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

        
        
          
            
            <li class="nav-item d-none d-lg-inline-flex">
              <a class="nav-link" href="https://twitter.com/MattOldach" data-toggle="tooltip" data-placement="bottom" title="Follow me on Twitter" target="_blank" rel="noopener" aria-label="Follow me on Twitter">
                <i class="fab fa-twitter" aria-hidden="true"></i>
              </a>
            </li>
          
        

        
        
        
        <li class="nav-item">
          <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        
        
        
        <li class="nav-item dropdown theme-dropdown">
          <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-label="Display preferences">
            <i class="fas fa-moon" aria-hidden="true"></i>
          </a>
          <div class="dropdown-menu">
            <a href="#" class="dropdown-item js-set-theme-light">
              <span>Light</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-dark">
              <span>Dark</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-auto">
              <span>Automatic</span>
            </a>
          </div>
        </li>
        

        
        

      </ul>

    </div>
  </nav>
</header>


  </div>

  <div class="page-body">
    
    
    

    <article class="article">

  






















  
  



<div class="article-container pt-3">
  <h1>TensorFlow CNN for Fast Style Transfer</h1>

  

  


<div class="article-metadata">

  
  
  
  
  <div>
    

  <span >
      Matthew J. Oldach</span>
  </div>
  
  

  
  <span class="article-date">
    
    
      
    
    Apr 21, 2019
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    5 min read
  </span>
  

  
  
  
  

  
  

</div>

  





</div>


<div class="article-header article-container featured-image-wrapper mt-4 mb-4" style="max-width: 585px; max-height: 795px;">
  <div style="position: relative">
    <img src="/post/faststyletransfer/featured_hu04aadbef1522b6c0e31c4d0b6c165177_624864_fde561fc15318ea159d1424e8e376e11.webp" width="585" height="795" alt="" class="featured-image">
    
  </div>
</div>



  <div class="article-container">

    <div class="article-style">
      <p>Volcom was founded in 1991, it was the first company to combine skateboarding, surfing and snowboarding under one brand from it&rsquo;s incepetion. I always loved how their aesthethics captured the energy and artistry of board-riding in its purest form.</p>
<p>If you have no idea what I&rsquo;m talking about here&rsquo;s some samples from print advertisments and a clip from 2003&rsquo;s <a href="https://www.youtube.com/watch?v=VGBQw46BbWA" target="_blank" rel="noopener"><strong>Big Youth Happening</strong></a> which I would say was the ultimate inspiration for this post.</p>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="" srcset="
               /post/faststyletransfer/volcom_huc406feca3dabf7149ea9dc5169e14965_1515696_6e4277669f51e061b91c4747193eeee5.webp 400w,
               /post/faststyletransfer/volcom_huc406feca3dabf7149ea9dc5169e14965_1515696_4ed14925491a66c3a0ad890bb6729c2c.webp 760w,
               /post/faststyletransfer/volcom_huc406feca3dabf7149ea9dc5169e14965_1515696_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
               src="/post/faststyletransfer/volcom_huc406feca3dabf7149ea9dc5169e14965_1515696_6e4277669f51e061b91c4747193eeee5.webp"
               width="760"
               height="253"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt=""
           src="/post/faststyletransfer/bigYouth.gif"
           loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<p>Non-photorealistic rendering (<a href="https://books.google.ca/books?id=YjXlTPFYGEYC&amp;redir_esc=y" target="_blank" rel="noopener">NPR</a>) is a combination of computer graphics and computer vision that produces renderings in various artistic, expressive or stylized ways. A new art form that couldn&rsquo;t have existed without computers. Researchers have proposed many algorithms and <em>styles</em> such as painting, pen-and-ink drawing, tile mosaics, stippling, streamline visualization, and tensor field visualization. Although the details vary, the goal is to make an image look like some other image. Two main approaches to designing these algorithms exist. <em>Greedy algorithms</em> greedily place strokes to match the target goas. <em>Optimization algorithms</em> iteratively place and then adjust stroke positions to minimize the objective function. NPR can be done using a number of machine learning methods, most commonly <a href="https://vimeo.com/302584040" target="_blank" rel="noopener">General Adverserial Networks</a> or <a href="https://www.youtube.com/watch?v=UFffxcCQMPQ" target="_blank" rel="noopener">Convolution Neural Networks</a>(CNN) such as painting and drawing.</p>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="" srcset="
               /post/faststyletransfer/example_hua721ea6717291d1fc23ecedebcf1af99_1097681_f9257feb6ffad45f895b7d7ee59fb531.webp 400w,
               /post/faststyletransfer/example_hua721ea6717291d1fc23ecedebcf1af99_1097681_c6ad496f8d4c3b0be4412d2156833373.webp 760w,
               /post/faststyletransfer/example_hua721ea6717291d1fc23ecedebcf1af99_1097681_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
               src="/post/faststyletransfer/example_hua721ea6717291d1fc23ecedebcf1af99_1097681_f9257feb6ffad45f895b7d7ee59fb531.webp"
               width="748"
               height="760"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<p>I wanted to use <a href="https://github.com/lengstrom/fast-style-transfer" target="_blank" rel="noopener">lengstrom/fast-style-transfer</a>, an <em>optimization technique</em>, on a video of my friends and I backcountry skiing and snowboarding in The Rocky Mountains of Alberta.</p>
<p>Fast-style-transfer is a TensorFlow CNN model based on a combination of <a href="https://arxiv.org/abs/1508.06576" target="_blank" rel="noopener">Gatys&rsquo; A Neural Algorithm of Artistic Style</a>, Johnson&rsquo;s <a href="http://cs.stanford.edu/people/jcjohns/eccv16/" target="_blank" rel="noopener">Perceptual Losses for Real-Time Style Transfer and Super-Resolution</a>, and Ulyanov&rsquo;s <a href="https://arxiv.org/abs/1607.08022" target="_blank" rel="noopener">Instance Normalization</a>. I&rsquo;ll skip the details here because it&rsquo;s been been far better described in the publications above (or in layman&rsquo;s terms <a href="https://towardsdatascience.com/a-journey-into-convolutional-neural-network-visualization-1abc71605209" target="_blank" rel="noopener">here</a>, <a href="https://medium.com/tensorflow/neural-style-transfer-creating-art-with-deep-learning-using-tf-keras-and-eager-execution-7d541ac31398" target="_blank" rel="noopener">here</a>, and <a href="https://towardsdatascience.com/intuitively-understanding-convolutions-for-deep-learning-1f6f42faee1" target="_blank" rel="noopener">here</a>), suffice it to say it allows you to compose images/videos in the style of another image. Besides being fun it&rsquo;s a nice visual way of showing the capabilities and internal representations of neural networks.</p>
<p><code>fast-style-transfer</code> repo comes with 6 trained models on famous paintings, allowing you to quikcly style your images (or videos) like them. But what&rsquo;s the fun in doing what others have alread done?</p>
<p>I wanted to see what kind of effect would be produced by training style transfer networks around interesting shapes and patterns! I selected a number patterns I thought would be interesting, for example animal patterns, fractals, fibonnaci sequences, a few vaporwave images (<a href="https://github.com/moldach/vapoRwave" target="_blank" rel="noopener">of course</a>), and a bunch of images taken under a <a href="https://en.wikipedia.org/wiki/Scanning_electron_microscope" target="_blank" rel="noopener">SEM microscope</a>.</p>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="" srcset="
               /post/faststyletransfer/collage_hu571b88c0b4b1510f09fe04bf98e8e804_9263891_36d95f5b2e8c28f7262a281bd669e9e3.webp 400w,
               /post/faststyletransfer/collage_hu571b88c0b4b1510f09fe04bf98e8e804_9263891_e1be426b1b323890fa0302435535a8a7.webp 760w,
               /post/faststyletransfer/collage_hu571b88c0b4b1510f09fe04bf98e8e804_9263891_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
               src="/post/faststyletransfer/collage_hu571b88c0b4b1510f09fe04bf98e8e804_9263891_36d95f5b2e8c28f7262a281bd669e9e3.webp"
               width="609"
               height="760"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<p>I then constructed a script to train 50 models simultaneously on a HPC (using a <a href="https://images.nvidia.com/content/technologies/volta/pdf/tesla-volta-v100-datasheet-letter-fnl-web.pdf" target="_blank" rel="noopener">GPU NVIDIA V100 Volta</a>; a top-of-the-line $10,000 GPU - <em>spared no expense</em>). After <em>many many</em> hours of training, across hundreds of cores, I selected the 20 best (<em>i.e.</em> most aesthetically pleasing) models to apply to the video.</p>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt=""
           src="/post/faststyletransfer/mountains.gif"
           loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<p>(<strong>The entire high-quality video can be found here</strong>](<a href="https://youtu.be/TuN4456PK-c%29" target="_blank" rel="noopener">https://youtu.be/TuN4456PK-c)</a>.</p>
<h3 id="technical-notes">Technical Notes:</h3>
<p>When training the models I noticed that the checkpoint files were being corrupted. I found a <a href="https://github.com/lengstrom/fast-style-transfer/issues/78#issuecomment-302307215" target="_blank" rel="noopener">closed issue on the repo: #78</a> stating that Tensorflow&rsquo;s Saver class was updated so you&rsquo;ll need to change line 136 in <code>/src/optimize.py</code>.</p>
<p>The script for training all of the networks on an HPC with a SLURM job scheduler is below, and can be run with <code>bash fastTrainer.bash &lt;image_path&gt; &lt;out_path&gt; &lt;test_path&gt;</code>. Simply clone <a href="https://github.com/lengstrom/fast-style-transfer" target="_blank" rel="noopener">lengstrom/fast-style-transfer</a> and create three folders inside. Create a sub-directory where you&rsquo;ll put all the <strong>style images</strong> you want to train, another sub-directory for the <strong>output</strong> (<code>.ckpt</code> files used to style your <code>.mp4</code> videos), and a <strong>test</strong> sub-directory for the model. As a default I used the <code>chicago</code> for training and I&rsquo;m not entirely sure if that makes a difference.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">!/bin/bash
</span></span><span class="line"><span class="cl"><span class="c1">#$ -pwd</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># bash fastTrainer.bash /images/ /outpath/ /testpath/</span>
</span></span><span class="line"><span class="cl"><span class="c1">##</span>
</span></span><span class="line"><span class="cl"><span class="c1">## An embarrassingly parallel script to train many style transfer networks on a HPC</span>
</span></span><span class="line"><span class="cl"><span class="c1">## Access to SLURM job scheduler and fast-style-transfer is required to run this program.</span>
</span></span><span class="line"><span class="cl"><span class="c1">## The three mandatory pathways must be specified in the indicated order.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">IMG</span><span class="o">=</span><span class="k">$(</span>readlink -f <span class="s2">&#34;</span><span class="si">${</span><span class="nv">1</span><span class="p">%/</span><span class="si">}</span><span class="s2">&#34;</span><span class="k">)</span>     <span class="c1"># path_to_train_images</span>
</span></span><span class="line"><span class="cl"><span class="nv">OUT_DIR</span><span class="o">=</span><span class="k">$(</span>readlink -f <span class="s2">&#34;</span><span class="si">${</span><span class="nv">2</span><span class="p">%/</span><span class="si">}</span><span class="s2">&#34;</span><span class="k">)</span>  <span class="c1"># path_to_checkpoints</span>
</span></span><span class="line"><span class="cl"><span class="nv">TEST</span><span class="o">=</span><span class="k">$(</span>readlink -f <span class="s2">&#34;</span><span class="si">${</span><span class="nv">3</span><span class="p">%/</span><span class="si">}</span><span class="s2">&#34;</span><span class="k">)</span>  <span class="c1"># path_to_tests</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">mkdir -p <span class="si">${</span><span class="nv">OUT_DIR</span><span class="si">}</span>/jobs
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">JID</span><span class="o">=</span><span class="m">0</span>   <span class="c1"># job ID for SLURM job name</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> f in <span class="si">${</span><span class="nv">IMG</span><span class="si">}</span>/*<span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nb">let</span> <span class="nv">JID</span><span class="o">=(</span>JID+1<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  cat &gt; <span class="si">${</span><span class="nv">OUT_DIR</span><span class="si">}</span>/jobs/style_<span class="si">${</span><span class="nv">JID</span><span class="si">}</span>.bash <span class="s">&lt;&lt; EOT # write job information for each job
</span></span></span><span class="line"><span class="cl"><span class="s">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="s">#SBATCH --gres=gpu:1        # request GPU
</span></span></span><span class="line"><span class="cl"><span class="s">#SBATCH --cpus-per-task=2   # maximum CPU cores per GPU request
</span></span></span><span class="line"><span class="cl"><span class="s">#SBATCH --time=00:01:00     # request 8 hours of walltime
</span></span></span><span class="line"><span class="cl"><span class="s">#SBATCH --job-name=&#34;fst_${JID}&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">#SBATCH --output=${OUT_DIR}/jobs/%N-%j.out  # %N for node name, %j for jobID
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">### JOB SCRIPT BELLOW ###
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s"># Load Modules
</span></span></span><span class="line"><span class="cl"><span class="s">module load python/2.7.14
</span></span></span><span class="line"><span class="cl"><span class="s">module load scipy-stack
</span></span></span><span class="line"><span class="cl"><span class="s">source tensorflow/bin/activate
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">mkdir ${OUT_DIR}/${JID}
</span></span></span><span class="line"><span class="cl"><span class="s">mkdir ${TEST}/${JID}
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">python style.py --style $f \
</span></span></span><span class="line"><span class="cl"><span class="s">  --checkpoint-dir ${OUT_DIR}/${JID} \
</span></span></span><span class="line"><span class="cl"><span class="s">  --test examples/content/chicago.jpg \
</span></span></span><span class="line"><span class="cl"><span class="s">  --test-dir ${OUT_DIR}/${JID} \
</span></span></span><span class="line"><span class="cl"><span class="s">  --content-weight 1.5e1 \
</span></span></span><span class="line"><span class="cl"><span class="s">  --checkpoint-iterations 1000 \
</span></span></span><span class="line"><span class="cl"><span class="s">  --batch-size 20
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">EOT</span>
</span></span><span class="line"><span class="cl">  chmod <span class="m">754</span> <span class="k">$(</span>readlink -f <span class="s2">&#34;</span><span class="si">${</span><span class="nv">OUT_DIR</span><span class="si">}</span><span class="s2">&#34;</span><span class="k">)</span>/jobs/style_<span class="si">${</span><span class="nv">JID</span><span class="si">}</span>.bash
</span></span><span class="line"><span class="cl">  sbatch <span class="k">$(</span>readlink -f <span class="s2">&#34;</span><span class="si">${</span><span class="nv">OUT_DIR</span><span class="si">}</span><span class="s2">&#34;</span><span class="k">)</span>/jobs/style_<span class="si">${</span><span class="nv">JID</span><span class="si">}</span>.bash
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span></code></pre></div><h2 id="what-i-learned">What I learned</h2>
<p>Now <a href="https://www.technologyreview.com/s/612913/a-philosopher-argues-that-an-ai-can-never-be-an-artist/" target="_blank" rel="noopener">Sean Dorrance Kelly</a> might argue I&rsquo;m using the machines &ldquo;creativity&rdquo; as a subsititute for my own but I would disagree since there was a fair amount of creativity in selecting images to train models on and the editing itself. That being said an <a href="https://www.christies.com/features/A-collaboration-between-two-artists-one-human-one-a-machine-9332-1.aspx" target="_blank" rel="noopener">AI generated work of art recently sold for $432,500 at Christie&rsquo;s</a> (the first auction house to offer a piece of art created by an algorithm).</p>
<p>Besides the opportunity to exercise my right-brain, it was a good chance to gain some experience with tensorflow and python. This project was also illuminating because it made the hidden layers of networks more comprehensible by literally allowing me to <em>see</em> how neural networks are performing!</p>
<p>I think the field of <strong>Feature visualization</strong> is exciting because it allows to peer behind the curtain and see how networks learn to classify images accurately. Take for example the <a href="https://distill.pub/2019/activation-atlas/?utm_campaign=Data_Elixir&amp;utm_medium=email&amp;utm_source=Data_Elixir_224" target="_blank" rel="noopener">Activation atlas</a> which reveals visual abstractions within a model. It gives a global view of a dataset by showing feature visualization of averaged activation values from a neural network.</p>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="" srcset="
               /post/faststyletransfer/atlas_hu441115eb4fc19f5f40e916fee9f80cb9_1868296_bb6c2b7c8e30a5775ac2f97426e5e33b.webp 400w,
               /post/faststyletransfer/atlas_hu441115eb4fc19f5f40e916fee9f80cb9_1868296_d9460e2414fa8ebb1ad30845bb28b1d8.webp 760w,
               /post/faststyletransfer/atlas_hu441115eb4fc19f5f40e916fee9f80cb9_1868296_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
               src="/post/faststyletransfer/atlas_hu441115eb4fc19f5f40e916fee9f80cb9_1868296_bb6c2b7c8e30a5775ac2f97426e5e33b.webp"
               width="760"
               height="536"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<blockquote>
<p>As an analogy, while the 26 letters in the alphabet provide a basis for English, seeing how letters are commonly combined to make words gives far more insight into the concepts that can be expressed than the letters alone. Similarly, activation atlases give us a bigger picture view by showing common combinations of neurons.</p>
</blockquote>
<p>In a perfect world the artist/user should have control over the decisions made by the algorithm. For example, to specify spatially varying styles to use, so that different rendering styles are used in different parts of the image, or to specify positions of individuial strokes. However, training these models is still too slow to be useful in an interactive application.</p>

    </div>

    







<div class="share-box">
  <ul class="share">
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fexample.com%2Fpost%2Ffaststyletransfer%2F&amp;text=TensorFlow&#43;CNN&#43;for&#43;Fast&#43;Style&#43;Transfer" target="_blank" rel="noopener" class="share-btn-twitter" aria-label="twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fexample.com%2Fpost%2Ffaststyletransfer%2F&amp;t=TensorFlow&#43;CNN&#43;for&#43;Fast&#43;Style&#43;Transfer" target="_blank" rel="noopener" class="share-btn-facebook" aria-label="facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
        
      
      <li>
        <a href="mailto:?subject=TensorFlow%20CNN%20for%20Fast%20Style%20Transfer&amp;body=https%3A%2F%2Fexample.com%2Fpost%2Ffaststyletransfer%2F" target="_blank" rel="noopener" class="share-btn-email" aria-label="envelope">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fexample.com%2Fpost%2Ffaststyletransfer%2F&amp;title=TensorFlow&#43;CNN&#43;for&#43;Fast&#43;Style&#43;Transfer" target="_blank" rel="noopener" class="share-btn-linkedin" aria-label="linkedin-in">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="whatsapp://send?text=TensorFlow&#43;CNN&#43;for&#43;Fast&#43;Style&#43;Transfer%20https%3A%2F%2Fexample.com%2Fpost%2Ffaststyletransfer%2F" target="_blank" rel="noopener" class="share-btn-whatsapp" aria-label="whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=https%3A%2F%2Fexample.com%2Fpost%2Ffaststyletransfer%2F&amp;title=TensorFlow&#43;CNN&#43;for&#43;Fast&#43;Style&#43;Transfer" target="_blank" rel="noopener" class="share-btn-weibo" aria-label="weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>











  
  
    




  
















  </div>
</article>
  </div>

  <div class="page-footer">
    
    
    <div class="container">
      <footer class="site-footer">

  












  
  
  
  
  













  
  
  

  
  
    
  
  
    
  

  

  
  <p class="powered-by copyright-license-text">
    © 2023 Matthew J. Oldach, M.Sc. This work is licensed under <a href="https://creativecommons.org/licenses/by-nc-nd/4.0" rel="noopener noreferrer" target="_blank">CC BY NC ND 4.0</a>
  </p>
  

  <p class="powered-by footer-license-icons">
    <a href="https://creativecommons.org/licenses/by-nc-nd/4.0" rel="noopener noreferrer" target="_blank" aria-label="Creative Commons">
      <i class="fab fa-creative-commons fa-2x" aria-hidden="true"></i>
      <i class="fab fa-creative-commons-by fa-2x" aria-hidden="true"></i>
      
        <i class="fab fa-creative-commons-nc fa-2x" aria-hidden="true"></i>
      
      
        <i class="fab fa-creative-commons-nd fa-2x" aria-hidden="true"></i>
      
    </a>
  </p>





  <p class="powered-by">
    
    
    
      
      
      
      
      
      
      Published with <a href="https://hugoblox.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Hugo Blox Builder</a> — the free, <a href="https://github.com/HugoBlox/hugo-blox-builder" target="_blank" rel="noopener">open source</a> website builder that empowers creators.
    
  </p>
</footer>

    </div>
    
  </div>

  


<script src="/js/vendor-bundle.min.938a3a7554cd9f6602290411f64d2617.js"></script>




  

  
  

  






  <script src="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.min.js" integrity="" crossorigin="anonymous"></script>








  
  <script id="search-hit-fuse-template" type="text/x-template">
    <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
    </div>
  </script>
  
    <script src="https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js" integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js" integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin="anonymous"></script>
  












  
  
  
  
  
  
  

















<script id="page-data" type="application/json">{"use_headroom":true}</script>


  <script src="/js/wowchemy-headroom.db4755770454eb63685f8de785c0a172.js" type="module"></script>









  
  


<script src="/en/js/wowchemy.min.62586ca65ca61821fe707eb9fa6268b7.js"></script>



  <script src="/js/wowchemy-map.a26e9d2f7238ba5b868384f1c5bc6477.js" type="module"></script>




  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        
        <pre><code></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>


  <script src="/js/wowchemy-publication.9137013a66774049159934c29c3f0205.js" type="module"></script>


















</body>
</html>
